# 统计决策理论与贝叶斯分析



#### 引言

**两个学派：**

- 频率学派：

  建立在**测度轮**基础上的**公理化**体系

  基本观点：数据看成是一定概率分布的总体，研究对象是这个**总体**而不局限于数据本身

  依据：总体信息（模型）和样本信息（数据）

- 贝叶斯学派

  起源于贝叶斯的两项工作

  - 贝叶斯定理
  - 贝叶斯假设

  基本观点：任何一个未知量$\theta$都被看作为随机变量，应用一个概率分布去描述对$\theta$的未知情况。在抽样前就具有先验分布

  依据：总体信息（模型）和样本信息（数据）和先验信息



**两个学派之间的差异：**

1. 对概率的概念理解有差别：
   - 频率学派：坚持概率的频率解释
   - 贝叶斯学：派赞成主观概率
2. 统计推断理念的差异：
   - 频率学派：选定模型、确定统计量、决定统计量的分布
   - 贝叶斯学派：先验信息+样本信息->后验信息



**两个学派之间的批评：**

- 对贝叶斯学派的批评：
  1. 参数看成是随机变量是否妥当？
  2. 先验分布是否存在？如何选取？
- 对频率学派的批评：
  1. 问题的提法不妥当
  2. 判断统计方法好坏的标准不妥当



**贝叶斯假设：**

无信息先验分布（Non-informative Priors）应该选取在$\theta$**取值范围内的均匀分布**



**现代贝叶斯统计理论研究现状**

1. 先验分布理论的研究

   可以分为两类

   - 无信息先验分布

     一般采用取值范围内的均匀分布，贝叶斯假设

   - 共轭先验分布

     如果先验分布和似然函数可以使得先验分布和后验分布有相同的形式，则先验分布和似然函数是共轭的

     对于正太分布$N(\mu, \sigma^2)$而言，

     1. $\mu$已知，$\sigma$未知，$\sigma$的共轭分布族为逆伽马分布
     2. $\mu$未知，$\sigma$未知，参数的共轭分布族为正太-逆伽马分布

   

2. 后验分布的统计推断

   - 蒙特卡洛方法
   - 利用共轭先验分布的特性



#### 先验分布和后验分布

**统计推断中可用的三种信息**

1. 总体信息
2. 样本信息
3. 先验信息



**贝叶斯公式的三种形式**

1. 事件形式：

   $P(A_i|B) = \frac{P(A_i,B)}{P(B)}=\frac{P(B|A_i)P(A_i)}{\sum_{j=1}^kP(B|A_j)P(A_j)}$

2. 密度函数形式：

   - 先验分布$\pi(\theta)$
   - 后验分布$h(x_1, ...,x_n,\theta)=p(x_1,...,x_n|\theta)\pi(\theta)$

   $\pi(\theta|x_1,...x_n)=\frac{h(x_1,...,x_n,\theta)}{m(x_1,...,x_n)}=\frac{p(x_1,...,x_n|\theta)\pi(\theta)}{\int_{\Theta}{p(x_1,...,x_n|\theta)\pi(\theta)d\theta}}$

3. 离散形式：

   $\pi(\theta_i|x)=\frac{p(x|\theta_i)\pi(\theta_i)}{\sum_jp(x|\theta_j)\pi(\theta_j)}$



**后验分布是三种信息的综合**

![例1.4](./assert/1-4.jpg)

![具体算例](./assert/1-5.jpg)



**伽马分布和贝塔分布：**

- 伽马分布

  $\Gamma(s)=\int_0^{\infty}x^{s-1}e^{-x}dx,s>0$

  $\Gamma(s+1)=s\Gamma(s),\Gamma(n+1)=n!$

- 贝塔分布

  $\Beta(p,q)=\int_0^1x^{p-1}(1-x)^{q-1}dx,p>0,q>0$

  $\Beta(p,q)=\frac{\Gamma(p)\Gamma(q)}{\Gamma(p+q)}$

  $\beta_I(p,q)=\beta_e(p,q)=\frac{\Gamma(p+q)}{\Gamma(p)\Gamma(q)}\theta^{p-1}(1-\theta)^{q-1}$

  特例：

  1. $p=q=1$时，$\beta_I(1,1)$为区间[0, 1]上的均匀分布
  2. $p=q=1/2$时，$\beta_I(1/2,1/2)$为反余弦函数



**投资决策问题：**

为了提高某产品的质量，公司经理考虑增加投资来改进生产设备，预计需要投资90万元，但从投资效果来看，下属部门有两种意见：

- $\theta_1$：改进生成设备后，高质量产品可占比90%，可信度40%
- $\theta_2$：改进生成设备后，高质量产品可占比70%，可信度60%

加了一个实验A：试制了5个产品，全为高质量产品

![投资决策1](./assert/decision-1.jpg)

又增加了一个实验B：试制了10个产品，9个高质量产品

![投资决策2](./assert/decision-2.jpg)

问：如何决策



**共轭先验分布**

$\theta$是总体分布的参数，$\pi(\theta)$是$\theta$是先验密度函数，假设由样本信息得到后验密度函数与$\pi(\theta)$具有相同的形式，则称$\pi(\theta)$是$\theta$的**共轭先验分布**

共轭先验分布式对某一分布中的参数而言的



例1.6：证明正态均值（方差已知）的共轭先验分布是正太分布

正太分布的PDF=$\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\theta)^2}{2\sigma^2}}$











